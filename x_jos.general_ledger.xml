<?xml version="1.0"?>
<t t-name="__export__.ir_ui_view_904">
    <t t-call="report.html_container">
        <t t-call="report.internal_layout">
        <div class="page">
        <div align="center" class="row">
            <h1>General Ledger</h1>
        </div>
        <div class="row">
        <t t-set="accounts_amounts" t-value="{}"/>
        <t t-set="sortedaccounts" t-value="[]"/>

        <t t-foreach="docs" t-as="o">

                   <t>
                        <t t-set="this_account_amount" t-value="accounts_amounts.get(o.account_id.code, ['',0,0])"/>
                        <t t-esc="accounts_amounts.update({o.account_id.code: [o.account_id.name, this_account_amount[1] + o.debit,this_account_amount[2] + o.credit]})"/>
                   </t>
        </t>
        <t t-set="sortedaccounts" t-value="accounts_amounts.keys()"/>
        <t t-esc="sortedaccounts.sort()"/>


        <t t-foreach="sortedaccounts" t-as="accountman">
            <t t-set="entry_amounts" t-value="{}"/>
            <t t-set="sortedentries" t-value="[]"/>
            <t t-foreach="docs" t-as="l">
                   <t t-if="l.account_id.code == accountman">
                        <t t-set="this_entry_amount" t-value="entry_amounts.get(l.move_id.name, ['',0,0,'',''])"/>
                        <t t-esc="entry_amounts.update({l.move_id.name: [l.date,this_entry_amount[1] + l.debit,this_entry_amount[2] + l.credit,l.account_id.name,l.move_id.ref,l.partner_id.name]})"/>
                   </t>
            </t>
            <t t-set="sortedentries" t-value="[ (v,k) for k,v in entry_amounts.iteritems() ]"/>
            <t t-esc="sortedentries.sort()"/>
            <table style="background-color:#F4FBFF; border-top: thick double #0087D3" class="table table-condensed">
                <tr>
                    <td width="10%"><span t-esc="accountman"/></td>
                    <td width="60%"><span t-esc="accounts_amounts[accountman][0]" /></td>
                    <td class="text-right" width="10%"><span t-esc="accounts_amounts[accountman][1]"   t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: docs[0].company_id.currency_id}"/></td>
                    <td class="text-right" width="10%"><span t-esc="accounts_amounts[accountman][2]"  t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: docs[0].company_id.currency_id}"/></td>
                    <td class="text-right" width="10%"><span t-esc="accounts_amounts[accountman][1] - accounts_amounts[accountman][2]"  t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: docs[0].company_id.currency_id}"/></td>
                </tr>
            </table>
            <table style="font-size: 80%;" class="table table-condensed">
                <thead>
                    <tr>
                        <th>Journal Entry</th>
                        <th>Date</th>
                        <th>Memo</th>
                        <th>Partner</th>
                        <!--<th>Account</th>-->
                        <th>Debit</th>
                        <th>Credit</th>
                        <th>Balance</th>
                    </tr>
                </thead>
                <tbody class="invoice_tbody">
                    <t t-set="balance" t-value="0"/>
                    <tr t-foreach="sortedentries" t-as="entryman">
                        <t>
                            <t t-set="balance" t-value="balance + (entryman[0][1] - entryman[0][2])"/>
                        </t>
                           <td width="10%"><span t-esc="entryman[1]"/></td>
                           <td width="10%"><span t-esc="entryman[0][0]"/></td>
                           <td width="25%"><span t-esc="entryman[0][4]"/></td>
                           <td width="25%"><span t-esc="entryman[0][5]"/></td>
                           <!--<td width="20%"><span t-esc="entryman[0][3]"/></td>-->
                           <td class="text-right" width="10%"><span t-esc="entryman[0][1]" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: docs[0].company_id.currency_id}"/></td>
                           <td class="text-right" width="10%"><span t-esc="entryman[0][2]" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: docs[0].company_id.currency_id}"/></td>
                           <td class="text-right" width="10%"><span t-esc="balance" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: docs[0].company_id.currency_id}"/></td>
                    </tr>
                </tbody>
            </table>
            </t>
            </div>
            </div>
        </t>
    </t>
</t>
